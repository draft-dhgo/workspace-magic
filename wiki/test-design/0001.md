# 테스트 설계서 작성 - Workspace Magic

> 에이전트: test-design
> 일시: 2026-02-27 00:00
> 상위 문서: prd/PRD-CONSOLIDATED.md, docs/design.md

## 수행 내용

PRD-CONSOLIDATED.md와 docs/design.md를 기반으로 Workspace Magic 앱의 종합 테스트 설계서를 작성하였다.

### 분석한 상위 문서
- **PRD**: 9개 기능 요구사항 영역(앱 실행, 리소스 레지스트리, 조합 관리, GUI, 조합 적용, 충돌 처리, 진행 상태, 데이터 저장, 설치/배포) + 7개 비기능 요구사항 + 4개 엣지 케이스
- **설계서**: 5개 Main Process 서비스(StorageService, ResourceService, ComposeService, WorkspaceService, GitService), 3개 빌더(ClaudeStructureBuilder, McpConfigBuilder, WorktreeCreator), 1개 유틸리티(ConflictResolver), Renderer 측 4개 Store, IPC 채널 22개

### 작성한 테스트 범위
- **단위 테스트**: 11개 모듈, 총 98개 테스트 케이스
  - StorageService: 7개
  - GitService: 11개
  - ResourceService: 26개
  - ComposeService: 14개
  - WorkspaceService: 15개
  - ClaudeStructureBuilder: 8개
  - McpConfigBuilder: 3개
  - WorktreeCreator: 4개
  - ConflictResolver: 5개
  - Renderer Stores: 13개
  - Validators: 8개
- **통합 테스트**: 14개 테스트 케이스
- **E2E 테스트**: 15개 테스트 케이스

## 산출물

- `docs/test-design.md` - Workspace Magic 종합 테스트 설계서

## 주요 결정사항

1. **테스트 프레임워크**: 설계서에서 선정한 Vitest(단위/통합) + Playwright(E2E) 조합을 그대로 채택
2. **Mock 전략**: 파일 시스템은 memfs 또는 vitest.mock, git CLI는 child_process mock, Electron API는 수동 Mock 객체 사용
3. **커버리지 목표**: Main Process 서비스 90%+, 빌더 85%+, Store 80%+
4. **우선순위 체계**: P0(StorageService, WorkspaceService, 충돌 처리, 핵심 E2E) > P1(리소스/조합 CRUD, IPC 통합) > P2(Store, Validator, 보조 E2E)
5. **FR-9(설치/배포)와 NFR-안전(시스템 변경 금지)**: 자동화 테스트 대신 빌드 설정 검증 + 코드 리뷰로 대응

## 이슈 & 참고

1. **MCP 설정 병합 전략 미확정**: PRD의 열린 질문 "조합에 포함된 MCP 설정이 여러 개일 때 병합 전략"이 미결. UT-MCP-003에서 해당 케이스를 경계값으로 분류하여 추후 결정에 따라 기대 결과를 확정해야 함
2. **E2E-012 (git 미설치 환경)**: 실제 CI/CD 환경에서 git을 제거하고 테스트하기 어려울 수 있음. PATH 조작 또는 별도 컨테이너 환경 필요
3. **E2E-015 (드래그 앤 드롭)**: Playwright에서 OS 수준의 드래그 앤 드롭 시뮬레이션에 제약이 있을 수 있음. Electron의 `open-file` 이벤트를 프로그래밍 방식으로 트리거하는 대안 고려
4. **성능 테스트**: NFR-성능(.claude/ 생성 1초 이내)은 IT-004 통합 테스트에서 시간 측정으로 검증. 별도 벤치마크 스위트는 필요시 추가
