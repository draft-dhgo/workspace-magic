# Workspace Magic 개발 설계서 개정 (v2)

> 에이전트: dev-design
> 일시: 2026-02-27 15:00
> 상위 문서: prd/PRD-CONSOLIDATED.md

## 수행 내용

기존 `docs/design.md` (0001에서 작성)를 전면 개정하였다. PRD-CONSOLIDATED.md를 재분석하여 설계의 완성도와 명확성을 높였다.

### 주요 개정 내용

1. **모듈 의존성 그래프 추가** (섹션 3.4): 모듈 간 단방향 의존 관계를 시각적으로 명시하여 순환 의존 방지 원칙을 강화
2. **설계 원칙에 포터블 우선 추가** (섹션 1.2): PRD의 포터블 실행 요구사항을 설계 원칙으로 격상
3. **ComposeDetail 타입 구체화** (섹션 4.4): 포함된 리소스의 `missing` 플래그를 통한 참조 무결성 표현을 명시
4. **WorkspaceService 데이터 흐름 상세화** (섹션 4.5): 적용 결과 디렉토리 구조(settings.json 생성 로직 포함)를 단계별로 명확히 기술
5. **IPC 채널 테이블 개선** (섹션 6.1): 파라미터와 반환 타입을 포함한 상세 테이블로 재작성
6. **에러 처리 전략 강화** (섹션 8.3): 충돌 처리 시나리오(.claude/ 존재, .mcp.json 존재)를 테이블로 정리
7. **구현 순서 테이블 형식 개선** (섹션 10): 의존 관계를 명시한 테이블 형식으로 변경

## 산출물

- `docs/design.md` - Workspace Magic 개발 설계서 v2 (전면 개정)

## 주요 결정사항

1. **기존 설계 구조 유지**: 0001에서 결정한 기술 스택(electron-vite, Zustand, CodeMirror 6), 아키텍처(3계층 분리), 데이터 모델(단일 JSON)은 그대로 유지
2. **Builders 모듈 레이어 분리**: ClaudeStructureBuilder, McpConfigBuilder, WorktreeCreator를 Service 내부가 아닌 별도 builders/ 디렉토리로 분리하여 단일 책임 강화
3. **git IPC 핸들러 분리**: 기존에 app.ipc에 통합되어 있던 git 관련 IPC를 `git.ipc.ts`로 분리하여 응집도 향상

## 이슈 & 참고

- 0001에서 언급된 열린 질문 3건(MCP 병합 전략, 스킬 하위 파일 GUI UX, CLAUDE.md 포함 여부)은 여전히 미결 상태이며, 구현 전 사용자 확인이 필요하다
- PRD 향후 고려 사항(Scope 외) 5건은 설계에 포함하지 않았다
