---
name: prd-consolidate
description: This skill should be used when the user asks to "PRD 통합", "PRD 종합", "PRD 합치기", "통합 PRD 만들기", "PRD 정리". prd/ 디렉토리 내 모든 PRD를 분석하여 하나의 통합 문서로 만들고, 이를 기반으로 개발 파이프라인(설계 → 테스트 설계 → 구현 → 테스트 작성)을 실행합니다.
version: 0.1.0
allowed-tools: Read, Write, Edit, Task, TodoWrite, Grep, Glob, AskUserQuestion
---

# PRD 통합 스킬

`prd/` 디렉토리 내 모든 PRD 문서를 분석하고 하나의 통합 PRD로 종합한 뒤, 계층적 에이전트 파이프라인을 통해 개발 전체 프로세스를 실행하는 스킬입니다.

## When to Activate

다음 상황에서 이 스킬을 활성화합니다:
- 사용자가 **PRD 통합/종합**을 요청할 때
- 여러 PRD를 **하나로 합치고** 싶어할 때
- 통합 PRD를 기반으로 **개발 파이프라인**을 실행하고 싶을 때
- "PRD 정리해줘", "전체 PRD 묶어줘" 등의 요청

## 핵심 원칙: 계층적 위계

이 스킬이 생성하는 모든 산출물은 **엄격한 계층 구조**를 따릅니다:

```
통합 PRD (최상위) ─── 절대 불변의 요구사항 원본
  └─ 개발 설계서 ──── 통합 PRD를 100% 준수, 기술적 구현 설계
      └─ 테스트 설계서 ── 개발 설계서를 100% 준수, 테스트 전략 설계
          └─ 구현 코드 ──── 개발 설계서를 100% 준수, 실제 코드 작성
              └─ 테스트 코드 ── 테스트 설계서를 100% 준수, 테스트 코드 작성
```

**위계 규칙:**
- 하위 레벨은 상위 레벨 문서를 **절대 수정하지 않음**
- 하위 레벨은 상위 레벨 문서의 내용을 **그대로 따름**
- 상위 문서와 모순되는 내용을 하위 문서에 작성하지 않음
- 의문이 있으면 상위 문서를 우선으로 해석

## 동작 방식

### Step 1: PRD 수집

1. `prd/` 디렉토리를 Glob(`prd/PRD-*.md`, `prd/PRD.md`)으로 스캔
2. 모든 PRD 파일을 Read로 읽어들임
3. 각 PRD의 핵심 내용을 파악 (목표, 기능 요구사항, 비기능 요구사항, 사용자, 스코프)

### Step 2: 분석 & 충돌 해소

1. PRD 간 **중복 기능** 식별
2. PRD 간 **충돌/모순** 사항 발견
3. 공통 **비기능 요구사항** 추출
4. 충돌이 있으면 AskUserQuestion으로 사용자에게 확인

### Step 3: 통합 PRD 작성

`prd/PRD-CONSOLIDATED.md` 파일로 통합 문서를 작성합니다.

통합 PRD 구조:
```markdown
# 통합 PRD: {프로젝트명}

> 생성일: {날짜}
> 원본 PRD: {포함된 PRD 목록}

## 1. 프로젝트 개요
- 프로젝트 목적과 비전
- 핵심 가치 제안

## 2. 통합 목표
- 전체 PRD에서 추출한 목표 통합
- 우선순위 재정리

## 3. 사용자 정의
- 통합된 타깃 사용자 그룹
- 통합 사용자 시나리오

## 4. 기능 요구사항 (통합)
- 전체 기능 목록 (출처 PRD 명시)
- 기능 간 의존성 표시
- 통합 우선순위

## 5. 비기능 요구사항 (통합)
- 성능, 보안, 확장성 등

## 6. 시스템 아키텍처 개요
- 전체 시스템 구조
- 주요 컴포넌트 관계

## 7. 엣지 케이스 & 예외 처리 (통합)

## 8. 성공 지표 (통합)

## 9. 제약 조건 & 전제

## 10. 원본 PRD 참조표
- 각 PRD별 핵심 내용 요약 + 통합 매핑
```

### Step 4: 사용자 확인

1. 작성된 통합 PRD를 사용자에게 제시
2. 피드백 수집 및 반영
3. 최종 확정

### Step 5: 개발 파이프라인 실행 (선택)

통합 PRD 확정 후, 사용자에게 다음 단계를 제안합니다:

```
다음 단계를 선택하세요:
1. 개발 설계서 작성 → dev-design 에이전트 실행
2. 전체 파이프라인 실행 → 설계 → 테스트 설계 → 구현 → 테스트 순차 실행
3. 여기서 끝내기
```

파이프라인 실행 시 Task 도구로 에이전트를 **순차적으로** 호출합니다:

```
1. dev-design 에이전트 → docs/design.md 생성
2. test-design 에이전트 → docs/test-design.md 생성
3. implement 에이전트 → 실제 코드 구현
4. test-write 에이전트 → 테스트 코드 작성
```

각 에이전트 호출 시 반드시 **상위 산출물 경로**를 전달합니다.

## 산출물 저장 위치

```
프로젝트 루트/
├── prd/
│   ├── PRD-001.md            # 개별 PRD
│   ├── PRD-002.md
│   └── PRD-CONSOLIDATED.md   # 통합 PRD (이 스킬이 생성)
└── docs/
    ├── design.md             # 개발 설계서 (dev-design 에이전트)
    ├── test-design.md        # 테스트 설계서 (test-design 에이전트)
    └── ...
```

## 출력 형식

통합 완료 후 다음 형식으로 보고합니다:

```
📋 PRD 통합 완료

포함된 PRD: {PRD-001, PRD-002, ...}
통합 문서: prd/PRD-CONSOLIDATED.md

기능 요약:
- 총 {N}개 기능 요구사항 통합
- P0: {N}개 / P1: {N}개 / P2: {N}개

충돌 해소:
- {해소된 충돌 사항}

다음 단계:
- 개발 설계서 작성 (dev-design 에이전트)
```

## 필수: Wiki 기록

**통합 PRD 작성 완료 후 반드시 wiki에 기록한다. 이것은 생략할 수 없다.**

### 기록 절차

1. `wiki/prd-consolidate/` 디렉토리를 Glob(`wiki/prd-consolidate/*.md`)으로 스캔
2. 가장 큰 순번을 찾아 +1 (없으면 0001)
3. 4자리 zero-padding으로 파일명 생성 (예: `wiki/prd-consolidate/0001.md`)
4. 디렉토리가 없으면 생성

### 기록 내용

```markdown
# {작업 제목}

> 에이전트: prd-consolidate
> 일시: {YYYY-MM-DD HH:MM}
> 원본 PRD: {통합에 포함된 PRD 목록}

## 수행 내용

{무엇을 했는지 구체적으로}

## 산출물

- `prd/PRD-CONSOLIDATED.md` - {설명}

## 주요 결정사항

{충돌 해소, 우선순위 조정 등 결정과 근거}

## 이슈 & 참고

{발견한 문제, 후속 작업 필요 사항}
```

### 기록 시점

- `prd/PRD-CONSOLIDATED.md` 작성 완료 직후
- 파이프라인 에이전트 호출 전에 기록 완료

## 참고

- 에이전트 상세 스펙은 `references/pipeline.md` 참조
- 모든 에이전트는 `.claude/agents/` 디렉토리에 위치
- 에이전트 호출 순서를 절대 바꾸지 않음
- wiki 기록 상세 규칙은 wiki 스킬의 `references/wiki-rules.md` 참조
