# PRD-003: 리소스 가져오기 다중 선택

> 한 줄 요약: 스킬 디렉토리 가져오기와 파일 가져오기(에이전트/커맨드/MCP) 시 여러 항목을 한 번에 선택하여 일괄 등록할 수 있도록 개선한다.

## 1. 배경 (Background)

### 문제 정의
- 현재 리소스 가져오기 시 스킬은 디렉토리 1개, 에이전트/커맨드/MCP는 파일 1개만 선택 가능
- 여러 리소스를 등록하려면 가져오기 동작을 반복해야 하므로 비효율적

### 동기
- 실제 사용 시 여러 스킬이나 에이전트를 한 번에 등록하는 경우가 빈번함
- 반복적인 다이얼로그 선택 과정을 줄여 UX를 개선

## 2. 목표 (Goals)

### 핵심 목표
- [ ] 스킬 디렉토리 가져오기에서 여러 폴더를 동시에 선택하여 일괄 등록
- [ ] 에이전트/커맨드 파일 가져오기에서 여러 .md 파일을 동시에 선택하여 일괄 등록
- [ ] MCP 파일 가져오기에서 여러 .json 파일을 동시에 선택하여 일괄 등록

### 비목표 (Non-Goals)
- 드래그 앤 드롭으로 파일/폴더 등록 (향후 고려)
- 리소스 생성 방식 변경 (텍스트 입력으로 직접 생성하는 방식은 현행 유지)
- 소스 레포 다중 선택 (현재 스코프 외)

## 3. 사용자 (Users)

### 타깃 사용자
- Claude Code 워크스페이스를 구성하는 개발자
- 이미 로컬에 다수의 스킬/에이전트/커맨드/MCP 설정 파일을 보유하고 있는 사용자

### 사용자 시나리오
- **시나리오 1**: 사용자가 팀에서 공유받은 스킬 폴더 5개를 한 번에 등록하고 싶다. 디렉토리 선택 다이얼로그에서 5개 폴더를 모두 선택하여 일괄 등록한다.
- **시나리오 2**: 사용자가 다른 프로젝트에서 가져온 에이전트 .md 파일 3개를 한 번에 등록하고 싶다. 파일 선택 다이얼로그에서 3개 파일을 모두 선택하여 일괄 등록한다.

## 4. 기능 요구사항 (Functional Requirements)

### 핵심 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-1 | 스킬 디렉토리 다중 선택 | 디렉토리 선택 다이얼로그에서 여러 폴더를 동시에 선택 가능 | P0 |
| FR-2 | 에이전트/커맨드 파일 다중 선택 | 파일 선택 다이얼로그에서 여러 .md 파일을 동시에 선택 가능 | P0 |
| FR-3 | MCP 파일 다중 선택 | 파일 선택 다이얼로그에서 여러 .json 파일을 동시에 선택 가능 | P0 |
| FR-4 | 일괄 등록 결과 표시 | 다중 가져오기 후 성공/실패 건수를 사용자에게 알림 | P1 |

### 상세 플로우

#### 4-1. 스킬 디렉토리 다중 가져오기

1. 사용자가 "디렉토리에서 가져오기" 버튼 클릭
2. OS 디렉토리 선택 다이얼로그 표시 (다중 선택 가능: `multiSelections` 속성)
3. 사용자가 폴더 1개 이상을 선택
4. 선택한 각 폴더에 대해 기존 `importSkillFromDirectory` 로직 적용:
   - SKILL.md 존재 여부 검증
   - 유효한 폴더만 앱 데이터에 등록
5. 결과 표시: "N개 스킬 등록 완료" 또는 "N개 중 M개 실패" 등

#### 4-2. 파일 다중 가져오기 (에이전트/커맨드/MCP)

1. 사용자가 "파일에서 가져오기" 버튼 클릭
2. OS 파일 선택 다이얼로그 표시 (다중 선택 가능: `multiSelections` 속성)
   - 에이전트/커맨드: `.md` 파일 필터
   - MCP: `.json` 파일 필터
3. 사용자가 파일 1개 이상을 선택
4. 선택한 각 파일에 대해 기존 `importFromFile` 로직 적용
5. 결과 표시

## 5. 비기능 요구사항

- **호환성**: 기존 단일 선택 동작을 깨뜨리지 않음 (1개만 선택해도 정상 동작)
- **성능**: 다수의 파일/폴더를 선택해도 UI가 블로킹되지 않아야 함
- **에러 격리**: 다중 가져오기 시 하나의 항목이 실패해도 나머지 항목은 계속 처리

## 6. 엣지 케이스 & 예외 처리

| 상황 | 처리 방식 |
|------|-----------|
| 다중 선택한 폴더 중 일부에 SKILL.md가 없음 | 해당 폴더는 스킵, 나머지는 정상 등록 + 실패 건수 표시 |
| 다중 선택한 파일 중 일부가 파싱 실패 | 해당 파일은 스킵, 나머지는 정상 등록 + 실패 건수 표시 |
| 다중 선택한 항목 중 이미 동일한 이름의 리소스가 존재 | 중복 항목은 스킵 또는 덮어쓰기 (기존 동작 유지) |
| 사용자가 다이얼로그에서 아무것도 선택하지 않음 | 아무 동작 없이 다이얼로그 닫힘 (현행과 동일) |
| 선택한 항목이 모두 실패 | 에러 메시지로 전체 실패 사유 표시 |

## 7. 구현 영향 범위

### 변경이 필요한 레이어

| 레이어 | 파일 | 변경 내용 |
|--------|------|-----------|
| IPC 채널 | `ipc-channels.ts` | 다중 가져오기 채널 추가 또는 기존 채널 시그니처 변경 |
| 다이얼로그 IPC | `dialog.ipc.ts` | `multiSelections` 속성 추가하여 다중 선택 지원 |
| Preload API | `preload/api.ts` | 다중 선택 반환 타입 (`string[]`) 대응 |
| 리소스 서비스 | `resource.service.ts` | 다중 경로를 받아 일괄 처리하는 메서드 추가 |
| 리소스 IPC | `resource.ipc.ts` | 다중 가져오기 핸들러 추가 |
| 리소스 스토어 | `resource.store.ts` | 다중 가져오기 액션 추가 |
| UI | `ResourcePage.tsx` | 다중 가져오기 호출 및 결과 표시 |
| 타입 | `types.ts` | 필요 시 다중 결과 타입 추가 |

## 8. 변경 이력

| 날짜 | 변경 내용 | 작성자 |
|------|-----------|--------|
| 2026-02-27 | 초안 작성 | Claude & godaehyeon |
